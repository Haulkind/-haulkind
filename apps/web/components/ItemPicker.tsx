"use client";import { useState, useEffect } from "react";import { trpc } from "@/lib/trpc";interface SelectedItem {  id: number;  name: string;  quantity: number;  price: number;}interface ItemPickerProps {  onItemsChange: (items: SelectedItem[]) => void;}export default function ItemPicker({ onItemsChange }: ItemPickerProps) {  const [selectedCategoryId, setSelectedCategoryId] = useState<number | null>(null);  const [selectedItems, setSelectedItems] = useState<Map<number, SelectedItem>>(    new Map()  );  // Load main categories (parentId = null)  const { data: categoriesData, isLoading: isLoadingCategories } = trpc.items.list.useQuery({    parentId: null,  });  // Load items for selected category  const { data: itemsData, isLoading: isLoadingItems } = trpc.items.list.useQuery(    { parentId: String(selectedCategoryId!) },    { enabled: selectedCategoryId !== null }  );  const categories = categoriesData?.items || [];  const categoryItems = itemsData?.items || [];  const selectedCategory = categories.find((c) => c.id === selectedCategoryId);  // Notify parent when selected items change  useEffect(() => {    onItemsChange(Array.from(selectedItems.values()));  }, [selectedItems, onItemsChange]);  const handleCategoryClick = (categoryId: number) => {    setSelectedCategoryId(categoryId);  };  const handleBackToCategories = () => {    setSelectedCategoryId(null);  };  const handleItemClick = (item: typeof categoryItems[0]) => {    const newSelectedItems = new Map(selectedItems);        if (newSelectedItems.has(item.id)) {      // Item already selected - increment quantity      const existing = newSelectedItems.get(item.id)!;      newSelectedItems.set(item.id, {        ...existing,        quantity: existing.quantity + 1,      });    } else {      // New item - add with quantity 1      newSelectedItems.set(item.id, {        id: item.id,        name: item.name,        quantity: 1,        price: parseFloat(item.basePrice),      });    }    
